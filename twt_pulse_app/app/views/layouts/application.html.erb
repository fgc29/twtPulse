<!DOCTYPE html>
<html>
  <head>
    <title>Twitter Auth Example App</title>
    <%= stylesheet_link_tag    "application", media: "all", "data-turbolinks-track" => true %>
    <%= javascript_include_tag "application", "data-turbolinks-track" => true %>
    <%= csrf_meta_tags %>
  </head>
  <body>
    <div>
      <% if current_user %>
        Signed in as <strong><%= current_user.name %></strong>!
        <%= link_to "Sign out", signout_path, id: "sign_out" %>
      <% else %>
        <%= link_to "Sign in with Twitter", "/auth/twitter", id: "sign_in" %>
      <% end %>
    </div>
    <div>
    <%#= yield %>
      <% if current_user %>
        <%#= link_to "Start Stream", tweets_search_results_path %>
        <meta charset="utf-8">
        <style>

        body {
          background: #fcfcfa;
        }

        .stroke {
          fill: none;
          stroke: #000;
          stroke-width: 3px;
        }

        .fill {
          fill: #fff;
        }

        .graticule {
          fill: none;
          stroke: #777;
          stroke-width: .5px;
          stroke-opacity: .5;
        }

        .land {
          fill: #222;
        }

        .boundary {
          fill: none;
          stroke: #fff;
          stroke-width: .5px;
        }

        </style>
        <body>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script src="http://d3js.org/d3.geo.projection.v0.min.js"></script>
        <script src="http://d3js.org/topojson.v1.min.js"></script>
        <script>

        var width = 960,
            height = 500;

        var projection = d3.geo.aitoff()
            .scale(150)
            .translate([width / 2, height / 2])
            .precision(.1);

        var path = d3.geo.path()
            .projection(projection);

        var graticule = d3.geo.graticule();

        var svg = d3.select("body").append("svg")
            .attr("width", width)
            .attr("height", height);

        svg.append("defs").append("path")
            .datum({type: "Sphere"})
            .attr("id", "sphere")
            .attr("d", path);

        svg.append("use")
            .attr("class", "stroke")
            .attr("xlink:href", "#sphere");

        svg.append("use")
            .attr("class", "fill")
            .attr("xlink:href", "#sphere");

        svg.append("path")
            .datum(graticule)
            .attr("class", "graticule")
            .attr("d", path);

        d3.json("http://bl.ocks.org/mbostock/raw/4090846/world-110m.json", function(error, world) {
          svg.insert("path", ".graticule")
              .datum(topojson.feature(world, world.objects.land))
              .attr("class", "land")
              .attr("d", path);

          svg.insert("path", ".graticule")
              .datum(topojson.mesh(world, world.objects.countries, function(a, b) { return a !== b; }))
              .attr("class", "boundary")
              .attr("d", path);
        });

        d3.select(self.frameElement).style("height", height + "px");

        </script>
      <% end %>
      <div id="test">

      </div>
    </div>
  </body>
</html>
